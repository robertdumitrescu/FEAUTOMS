<div ng-init="initialize()"></div>

<div class="container-fluid">
    <h1>Light</h1>
    <div class="row">
        <div class="col-4">
            <div class="card">
                <h4 class="card-header">Last 20 collected values</h4>
                <div class="card-body">
                    <table class="table table-hover table-sm">
                        <thead>
                        <tr>
                            <th>#</th>
                            <th>Electrical</th>
                            <th>Light intensity</th>
                            <th>Created datetime</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr ng-repeat="measurement in MeasurementsViewerService.measurements">
                            <td>{{measurement.id}}</td>
                            <td>{{measurement.lightElectricalQuantity}}</td>
                            <td>{{measurement.lightIntensity}}</td>
                            <td>{{measurement.createdDateTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="col-8">
            <div class="row">
                <div class="col-3">
                    <div class="card mb-3">
                        <h4 class="card-header">All time</h4>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Highest: TBI</li>
                            <li class="list-group-item">Lowest: TBI</li>
                        </ul>
                    </div>
                </div>
                <div class="col-3">
                    <div class="card mb-3">
                        <h4 class="card-header">Last 24 hours</h4>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item">Highest: TBI</li>
                            <li class="list-group-item">Lowest: TBI</li>
                        </ul>
                    </div>
                </div>
                <div class="col-6">
                    <div class="card mb-3">
                        <h4 class="card-header">Instant
                            ({{convertToRelativeLightIntensity(MeasurementsViewerService.measurements[0].lightIntensity)}}%)</h4>
                        <div style="padding: 25px;">
                            <div class="skill-bar-wrapper">
                                <div class="skill-bar-container">
                                <span class="bar progress"
                                      style="width: {{convertToRelativeLightIntensity(MeasurementsViewerService.measurements[0].lightIntensity)}}%;">
                                </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    <div class="card mb-3">
                        <h4 class="card-header">Last 20 collected values - history chart</h4>
                        <div class="card-body">
                            <div class="chart-container" style="position: relative; height:30vh;">
                            <canvas id="line" class="chart chart-line" chart-data="MeasurementsViewerService.chart.values"
                                    chart-labels="MeasurementsViewerService.chart.labels" chart-series="series" chart-options="options"
                                    chart-dataset-override="datasetOverride" chart-click="onClick">
                            </canvas>
                        </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<button ng-click="test()">
    test
</button>
<style>
    .skill-bar-wrapper {
        list-style: none;
        font: 12px Helvetica Neue, Arial, Helvetica, Geneva, sans-serif;
        position: relative;
        line-height: 2em;
    }

    .skill-bar-container {
        background: #4b4a4b !important;
        height: 45px;
    }

    .progress {
        background-color: #ffaf03;
        transition: width 0.5s;
    }

    .bar {
        height: 45px;
        position: absolute;
    }
</style>